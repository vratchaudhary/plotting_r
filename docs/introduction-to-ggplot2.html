<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Introduction to ggplot2 | Plotting in R using ggplot</title>
  <meta name="description" content="This is a practical example of creating impactful visualizations for presenting results of scientific data analysis. Examples mainly use ggplot2 package in R." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Introduction to ggplot2 | Plotting in R using ggplot" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a practical example of creating impactful visualizations for presenting results of scientific data analysis. Examples mainly use ggplot2 package in R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Introduction to ggplot2 | Plotting in R using ggplot" />
  
  <meta name="twitter:description" content="This is a practical example of creating impactful visualizations for presenting results of scientific data analysis. Examples mainly use ggplot2 package in R." />
  

<meta name="author" content="Vratika Chaudhary" />


<meta name="date" content="2020-12-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>
<link rel="next" href="plotting-using-one-variable-at-a-time.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Plotting in R with ggplot</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Data preperation</a></li>
<li class="chapter" data-level="3" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html"><i class="fa fa-check"></i><b>3</b> Introduction to ggplot2</a><ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#creating-the-building-blocks-of-the-graph"><i class="fa fa-check"></i><b>3.1</b> Creating the building blocks of the graph</a></li>
<li class="chapter" data-level="3.2" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#adding-geom_objects"><i class="fa fa-check"></i><b>3.2</b> Adding geom_objects</a></li>
<li class="chapter" data-level="3.3" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#making-the-plot-visually-more-appealing"><i class="fa fa-check"></i><b>3.3</b> Making the plot visually more appealing</a></li>
<li class="chapter" data-level="3.4" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#lets-make-the-plot-colorful"><i class="fa fa-check"></i><b>3.4</b> Let’s make the plot colorful</a></li>
<li class="chapter" data-level="3.5" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#change-label-fonts-color-angle-etc"><i class="fa fa-check"></i><b>3.5</b> Change label fonts, color, angle etc</a></li>
<li class="chapter" data-level="3.6" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#you-can-also-create-and-save-a-theme-for-entire-project"><i class="fa fa-check"></i><b>3.6</b> You can also create and save a theme for entire project</a></li>
<li class="chapter" data-level="3.7" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#changing-colors-manually-and-add-error-bars"><i class="fa fa-check"></i><b>3.7</b> Changing colors manually and add error bars</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="plotting-using-one-variable-at-a-time.html"><a href="plotting-using-one-variable-at-a-time.html"><i class="fa fa-check"></i><b>4</b> Plotting using one variable at a time</a><ul>
<li class="chapter" data-level="4.1" data-path="plotting-using-one-variable-at-a-time.html"><a href="plotting-using-one-variable-at-a-time.html#histograms--plots-the-distribution-of-a-numerical-variable"><i class="fa fa-check"></i><b>4.1</b> Histograms- plots the distribution of a numerical variable</a></li>
<li class="chapter" data-level="4.2" data-path="plotting-using-one-variable-at-a-time.html"><a href="plotting-using-one-variable-at-a-time.html#bar-plots"><i class="fa fa-check"></i><b>4.2</b> Bar plots</a></li>
<li class="chapter" data-level="4.3" data-path="plotting-using-one-variable-at-a-time.html"><a href="plotting-using-one-variable-at-a-time.html#ordering-based-on-number-of-counts-from-lowest-to-highest"><i class="fa fa-check"></i><b>4.3</b> Ordering based on number of counts from lowest to highest</a></li>
<li class="chapter" data-level="4.4" data-path="plotting-using-one-variable-at-a-time.html"><a href="plotting-using-one-variable-at-a-time.html#adding-percentages"><i class="fa fa-check"></i><b>4.4</b> Adding percentages</a></li>
<li class="chapter" data-level="4.5" data-path="plotting-using-one-variable-at-a-time.html"><a href="plotting-using-one-variable-at-a-time.html#pie-chart"><i class="fa fa-check"></i><b>4.5</b> pie chart</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multivariate-plotting.html"><a href="multivariate-plotting.html"><i class="fa fa-check"></i><b>5</b> Multivariate plotting</a><ul>
<li class="chapter" data-level="5.1" data-path="multivariate-plotting.html"><a href="multivariate-plotting.html#bar-plot-with-categories-plot-depth-by-cut"><i class="fa fa-check"></i><b>5.1</b> Bar plot with categories, plot depth by cut</a></li>
<li class="chapter" data-level="5.2" data-path="multivariate-plotting.html"><a href="multivariate-plotting.html#bar-plot-with-categories-side-by-side"><i class="fa fa-check"></i><b>5.2</b> Bar plot with categories, side by side</a></li>
<li class="chapter" data-level="5.3" data-path="multivariate-plotting.html"><a href="multivariate-plotting.html#segemented-bar-plot-appealing-viz"><i class="fa fa-check"></i><b>5.3</b> Segemented bar plot, appealing viz</a></li>
<li class="chapter" data-level="5.4" data-path="multivariate-plotting.html"><a href="multivariate-plotting.html#scatter-plot"><i class="fa fa-check"></i><b>5.4</b> Scatter plot</a></li>
<li class="chapter" data-level="5.5" data-path="multivariate-plotting.html"><a href="multivariate-plotting.html#grouping-using-facets"><i class="fa fa-check"></i><b>5.5</b> Grouping using facets</a></li>
<li class="chapter" data-level="5.6" data-path="multivariate-plotting.html"><a href="multivariate-plotting.html#change-facet-labels"><i class="fa fa-check"></i><b>5.6</b> Change facet labels</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="publication-style-figures-and-saving.html"><a href="publication-style-figures-and-saving.html"><i class="fa fa-check"></i><b>6</b> Publication style figures and saving</a><ul>
<li class="chapter" data-level="6.1" data-path="publication-style-figures-and-saving.html"><a href="publication-style-figures-and-saving.html#time-series"><i class="fa fa-check"></i><b>6.1</b> Time series</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Plotting in R using ggplot</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduction-to-ggplot2" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Introduction to ggplot2</h1>
<p>The package ggplot2 is extremely functional and useful. It created graphs in layers and therefore is very intutive. It adds layers on top of each other</p>
<div id="creating-the-building-blocks-of-the-graph" class="section level2">
<h2><span class="header-section-number">3.1</span> Creating the building blocks of the graph</h2>
<p>ggplot(data = dataname, mapping= aes(x=xaxis, y= yaxis))</p>
<p>ggplot function from ggplot2 package requires two arguments:
data is the object name you gave to your data sets
Mapping is the specifications of the variables we want to visualize and are places withing the ‘aes’ function short for aesthetics.</p>
<p>Let’s bring back the chick data and let’s look how chicks have grown over time</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="introduction-to-ggplot2.html#cb16-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb16-2"><a href="introduction-to-ggplot2.html#cb16-2"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="fl">.1</span>, <span class="fl">.1</span>))</span>
<span id="cb16-3"><a href="introduction-to-ggplot2.html#cb16-3"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>ChickWeight, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>Time, <span class="dt">y=</span>weight))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:nice-fig"></span>
<img src="plotting_r_files/figure-html/nice-fig-1.png" alt="Building block" width="80%" />
<p class="caption">
Figure 3.1: Building block
</p>
</div>
<p>We see a box, and we see the correct axis but we don’t see anything else- why?</p>
</div>
<div id="adding-geom_objects" class="section level2">
<h2><span class="header-section-number">3.2</span> Adding geom_objects</h2>
<p>Because yes we told ggplot what variables we want to plot, but we haven’t told it what type of plot we want.
We can do this by adding a ‘geom_object’. For this purpose, let’s make a line plot. We can do so by adding a ‘geom_line’ object to the previous layer. We join the two layers by a ‘+’ sign.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="introduction-to-ggplot2.html#cb17-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb17-2"><a href="introduction-to-ggplot2.html#cb17-2"></a></span>
<span id="cb17-3"><a href="introduction-to-ggplot2.html#cb17-3"></a><span class="kw">ggplot</span>(ChickWeight, <span class="dt">mapping=</span> <span class="kw">aes</span>(<span class="dt">x=</span>Time, <span class="dt">y=</span>weight))<span class="op">+</span></span>
<span id="cb17-4"><a href="introduction-to-ggplot2.html#cb17-4"></a><span class="st">  </span><span class="kw">geom_line</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-10"></span>
<img src="plotting_r_files/figure-html/unnamed-chunk-10-1.png" alt="Line plot" width="80%" />
<p class="caption">
Figure 3.2: Line plot
</p>
</div>
<p>Hey! We got some lines, but it looks weird!!!
That is becasue we plotted all the data together, we had 48 chicks but we plotted all of them in the same plot. So let’s make them distinct. We can simply do so by giving a distinct line to each chick by adding group</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="introduction-to-ggplot2.html#cb18-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb18-2"><a href="introduction-to-ggplot2.html#cb18-2"></a></span>
<span id="cb18-3"><a href="introduction-to-ggplot2.html#cb18-3"></a><span class="kw">ggplot</span>(ChickWeight, <span class="kw">aes</span>(<span class="dt">x=</span>Time, <span class="dt">y=</span>weight, <span class="dt">group=</span>Chick))<span class="op">+</span></span>
<span id="cb18-4"><a href="introduction-to-ggplot2.html#cb18-4"></a><span class="st">  </span><span class="kw">geom_line</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-11"></span>
<img src="plotting_r_files/figure-html/unnamed-chunk-11-1.png" alt="Line plot with colors" width="80%" />
<p class="caption">
Figure 3.3: Line plot with colors
</p>
</div>
</div>
<div id="making-the-plot-visually-more-appealing" class="section level2">
<h2><span class="header-section-number">3.3</span> Making the plot visually more appealing</h2>
<p>Let’s do the following:
1. Increase the size of the lines
2. Lighten the background using the theme function in ggplot2
3. Increase the size of axis text and titles
4. Change y axis label</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="introduction-to-ggplot2.html#cb19-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb19-2"><a href="introduction-to-ggplot2.html#cb19-2"></a></span>
<span id="cb19-3"><a href="introduction-to-ggplot2.html#cb19-3"></a><span class="kw">ggplot</span>(ChickWeight, <span class="kw">aes</span>(<span class="dt">x=</span>Time, <span class="dt">y=</span>weight, <span class="dt">group=</span>Chick),<span class="dt">size=</span><span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb19-4"><a href="introduction-to-ggplot2.html#cb19-4"></a><span class="st">  </span><span class="kw">geom_line</span>()<span class="op">+</span></span>
<span id="cb19-5"><a href="introduction-to-ggplot2.html#cb19-5"></a><span class="st">  </span><span class="kw">theme_minimal</span>(<span class="dt">base_size =</span> <span class="dv">20</span>)<span class="op">+</span></span>
<span id="cb19-6"><a href="introduction-to-ggplot2.html#cb19-6"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Weight&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-12"></span>
<img src="plotting_r_files/figure-html/unnamed-chunk-12-1.png" alt="Better looking line plot with groups" width="80%" />
<p class="caption">
Figure 3.4: Better looking line plot with groups
</p>
</div>
</div>
<div id="lets-make-the-plot-colorful" class="section level2">
<h2><span class="header-section-number">3.4</span> Let’s make the plot colorful</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="introduction-to-ggplot2.html#cb20-1"></a><span class="kw">ggplot</span>(ChickWeight, <span class="kw">aes</span>(<span class="dt">x=</span>Time, <span class="dt">y=</span>weight, <span class="dt">color=</span>Chick),<span class="dt">size=</span><span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb20-2"><a href="introduction-to-ggplot2.html#cb20-2"></a><span class="st">  </span><span class="kw">geom_line</span>()<span class="op">+</span></span>
<span id="cb20-3"><a href="introduction-to-ggplot2.html#cb20-3"></a><span class="st">  </span><span class="kw">theme_minimal</span>(<span class="dt">base_size =</span> <span class="dv">20</span>)<span class="op">+</span></span>
<span id="cb20-4"><a href="introduction-to-ggplot2.html#cb20-4"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Weight&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-13"></span>
<img src="plotting_r_files/figure-html/unnamed-chunk-13-1.png" alt="Better looking line plot with colors" width="80%" />
<p class="caption">
Figure 3.5: Better looking line plot with colors
</p>
</div>
</div>
<div id="change-label-fonts-color-angle-etc" class="section level2">
<h2><span class="header-section-number">3.5</span> Change label fonts, color, angle etc</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="introduction-to-ggplot2.html#cb21-1"></a><span class="kw">ggplot</span>(ChickWeight, <span class="kw">aes</span>(<span class="dt">x=</span>Time, <span class="dt">y=</span>weight, <span class="dt">color=</span>Chick),<span class="dt">size=</span><span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb21-2"><a href="introduction-to-ggplot2.html#cb21-2"></a><span class="st">  </span><span class="kw">geom_line</span>()<span class="op">+</span></span>
<span id="cb21-3"><a href="introduction-to-ggplot2.html#cb21-3"></a><span class="st">  </span><span class="kw">theme_minimal</span>(<span class="dt">base_size =</span> <span class="dv">20</span>)<span class="op">+</span></span>
<span id="cb21-4"><a href="introduction-to-ggplot2.html#cb21-4"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Weight&quot;</span>)<span class="op">+</span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>( <span class="dt">angle=</span><span class="dv">40</span>,<span class="dt">vjust=</span><span class="fl">0.2</span>,<span class="dt">color=</span><span class="st">&#39;blue&#39;</span>,<span class="dt">family=</span><span class="st">&quot;Comic Sans MS&quot;</span>))<span class="op">+</span></span>
<span id="cb21-5"><a href="introduction-to-ggplot2.html#cb21-5"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span>  <span class="kw">element_text</span>( <span class="dt">color=</span><span class="st">&#39;purple&#39;</span>,<span class="dt">family=</span><span class="st">&quot;serif&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-14"></span>
<img src="plotting_r_files/figure-html/unnamed-chunk-14-1.png" alt="change label font" width="80%" />
<p class="caption">
Figure 3.6: change label font
</p>
</div>
</div>
<div id="you-can-also-create-and-save-a-theme-for-entire-project" class="section level2">
<h2><span class="header-section-number">3.6</span> You can also create and save a theme for entire project</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="introduction-to-ggplot2.html#cb22-1"></a>theme_set&lt;-<span class="cf">function</span>(){ <span class="kw">theme_bw</span>(<span class="dt">base_size =</span> <span class="dv">20</span>)<span class="op">+</span></span>
<span id="cb22-2"><a href="introduction-to-ggplot2.html#cb22-2"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">35</span>,<span class="dt">vjust=</span><span class="fl">0.8</span>,<span class="dt">color=</span><span class="st">&#39;green&#39;</span>))<span class="op">+</span></span>
<span id="cb22-3"><a href="introduction-to-ggplot2.html#cb22-3"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_blank</span>())}</span>
<span id="cb22-4"><a href="introduction-to-ggplot2.html#cb22-4"></a></span>
<span id="cb22-5"><a href="introduction-to-ggplot2.html#cb22-5"></a></span>
<span id="cb22-6"><a href="introduction-to-ggplot2.html#cb22-6"></a><span class="kw">ggplot</span>(ChickWeight, <span class="kw">aes</span>(<span class="dt">x=</span>Time, <span class="dt">y=</span>weight, <span class="dt">color=</span>Chick),<span class="dt">size=</span><span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb22-7"><a href="introduction-to-ggplot2.html#cb22-7"></a><span class="st">  </span><span class="kw">geom_line</span>()<span class="op">+</span><span class="kw">theme_set</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-15"></span>
<img src="plotting_r_files/figure-html/unnamed-chunk-15-1.png" alt="change label font" width="80%" />
<p class="caption">
Figure 3.7: change label font
</p>
</div>
</div>
<div id="changing-colors-manually-and-add-error-bars" class="section level2">
<h2><span class="header-section-number">3.7</span> Changing colors manually and add error bars</h2>
<p>Lets plot the mean chick weight over time for each type of diet</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="introduction-to-ggplot2.html#cb23-1"></a>ChickWeight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Diet,Time) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">mean.wt=</span><span class="kw">mean</span>(weight), </span>
<span id="cb23-2"><a href="introduction-to-ggplot2.html#cb23-2"></a>                  <span class="dt">se.weight=</span> (<span class="kw">sd</span>(weight)) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>((<span class="kw">length</span>(weight)))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb23-3"><a href="introduction-to-ggplot2.html#cb23-3"></a><span class="st">                 </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb23-4"><a href="introduction-to-ggplot2.html#cb23-4"></a><span class="st">              </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Time, <span class="dt">y=</span>mean.wt, <span class="dt">color=</span>Diet,<span class="dt">lty=</span>Diet),<span class="dt">size=</span><span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb23-5"><a href="introduction-to-ggplot2.html#cb23-5"></a><span class="st">            </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Time, <span class="dt">ymax=</span>mean.wt<span class="op">+</span>se.weight,<span class="dt">ymin=</span> mean.wt<span class="op">-</span>se.weight,<span class="dt">group=</span>Diet,<span class="dt">fill=</span>Diet),<span class="dt">size=</span><span class="dv">2</span>,<span class="dt">alpha=</span><span class="fl">0.2</span>)<span class="op">+</span></span>
<span id="cb23-6"><a href="introduction-to-ggplot2.html#cb23-6"></a><span class="st">              </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;cyan1&quot;</span>,<span class="st">&quot;cyan4&quot;</span>,<span class="st">&quot;green&quot;</span>,<span class="st">&quot;orange&quot;</span>))<span class="op">+</span></span>
<span id="cb23-7"><a href="introduction-to-ggplot2.html#cb23-7"></a><span class="st">            </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;cyan1&quot;</span>,<span class="st">&quot;cyan4&quot;</span>,<span class="st">&quot;green&quot;</span>,<span class="st">&quot;orange&quot;</span>))<span class="op">+</span></span>
<span id="cb23-8"><a href="introduction-to-ggplot2.html#cb23-8"></a><span class="st">              </span>ggpubr<span class="op">::</span><span class="kw">theme_pubr</span>(<span class="dt">base_size =</span> <span class="dv">20</span>)<span class="op">+</span></span>
<span id="cb23-9"><a href="introduction-to-ggplot2.html#cb23-9"></a><span class="st">                </span><span class="kw">ylab</span>(<span class="st">&quot;Mean weight&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-16"></span>
<img src="plotting_r_files/figure-html/unnamed-chunk-16-1.png" alt="change label font" width="80%" />
<p class="caption">
Figure 3.8: change label font
</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="plotting-using-one-variable-at-a-time.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["plotting_r.pdf", "plotting_r.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
